extends ../layout
block scripts
	script(src="https://js.recurly.com/v3/recurly.js")
	script(type='text/javascript').

		window.recomendedCurrency = '#{recomendedCurrency}'
		window.recurlyApiKey = "!{settings.apis.recurly.publicKey}"
		window.taxRate = #{taxRate}
		window.subscription = !{JSON.stringify(personalSubscription)}

block content
	.content.content-alt(ng-cloak)
		.container
			.row
				.col-md-8.col-md-offset-2
					.card
						-if (personalSubscription)
							include ./dashboard/_personal_subscription

						each groupSubscription in groupSubscriptions
							- if (user._id+'' != groupSubscription.admin_id._id+'')
								div 
									p !{translate("member_of_group_subscription", {admin_email: "<strong>" + groupSubscription.admin_id.email + "</strong>"})}
									span 
										button.btn.btn-danger.text-capitalise(ng-click="removeSelfFromGroup('"+groupSubscription.admin_id._id+"')") #{translate("leave_group")}
								hr

						if settings.overleaf && v1Subscriptions && v1Subscriptions.has_subscription
							p
								| You are subscribed to Overleaf through Overleaf v1
							p
								a.btn.btn-primary(href='/sign_in_to_v1?return_to=/users/edit%23status') Manage v1 Subscription
							hr

						if settings.overleaf && v1Subscriptions && v1Subscriptions.teams && v1Subscriptions.teams.length > 0
							for team in v1Subscriptions.teams
								p
									| You are a member of the Overleaf v1 team: <strong>#{team.name}</strong>
							p
								a.btn.btn-primary(href="/sign_in_to_v1?return_to=/teams") Manage v1 Team Membership
							hr



	script(type='text/ng-template', id='LeaveGroupModalTemplate')
		.modal-header
			h3 #{translate("leave_group")}
		.modal-body
			p #{translate("sure_you_want_to_leave_group")}
		.modal-footer
			button.btn.btn-default(
				ng-disabled="inflight"
				ng-click="cancel()"
			) #{translate("cancel")}
			button.btn.btn-danger(
				ng-disabled="state.inflight"
				ng-click="confirmLeaveGroup()"
			)
				span(ng-hide="inflight") #{translate("leave_now")}
				span(ng-show="inflight") #{translate("processing")}...
